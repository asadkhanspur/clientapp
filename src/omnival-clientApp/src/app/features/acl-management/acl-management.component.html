<div class="tabsDivFee">
  <ul class="nav nav-tabs" id="myTab" role="tablist">
    <li class="nav-item" *ngIf="permissions.RMRV">
      <a class="nav-link active" id="withloan-tab" data-toggle="tab" href="#roleListing" role="tab"
        aria-controls="withloan" aria-selected="true">Role Management</a>
    </li>
    <li class="nav-item" *ngIf="permissions.PRUMV">
      <a class="nav-link" [ngClass]="{'active': permissions.RMRV != true && permissions.PRUMV == true}"
        id="withoutloan-tab" data-toggle="tab" href="#userRole" role="tab" aria-controls="withoutloan"
        aria-selected="false">User Management</a>
    </li>

  </ul>

  <div class="tab-content" id="style-2">
    <div class="tab-pane fade show active" id="roleListing" role="tabpanel" aria-labelledby="withloan-tab"
      *ngIf="permissions.RMRV">
      <div class="generalFeeTabDiv">



        <div class="tableGrids">
          <h2 class="clearfix"> <button class="btn btn-primary" (click)="openAddSlider(0)"
              *ngIf="userRoleId == '1'">Create New Role</button></h2>
          <table class="table table-bordered">
            <thead class="thead-dark">
              <tr>
                <th scope="col" width="35%" (click)="sort('roleName',roleList)"><i class="fa fa-sort" aria-hidden="true"></i>
                  Role</th>
                <th scope="col" width="60%" (click)="sort('description',roleList)"><i class="fa fa-sort" aria-hidden="true"></i>
                  Description</th>
                <th scope="col" width="5%" *ngIf="userRoleId == '1'"> Actions</th>
              </tr>
            </thead>
            <tbody>

              <tr *ngFor="let data of roleList">

                <td>
                  <h3 class="tdVHeading" (click)="openViewSlider(data)">{{data.roleName}}</h3>
                </td>

                <td>
                  {{data.description}}
                </td>

                <td *ngIf="userRoleId == '1'">
                  <div class="editButtonDrop" *ngIf="data.roleId !== 1">
                    <div class="btn-group">
                      <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"
                        aria-haspopup="true" aria-expanded="false">
                        <i class="fa fa-ellipsis-v" aria-hidden="true"></i>
                      </button>
                      <div class="dropdown-menu dropdown-menu-right">
                        <button class="dropdown-item" type="button"
                          (click)="openEditSlider(data.clientRoleId)">Edit</button>
                        <button class="dropdown-item" type="button"
                          (click)="openModalWithClass(clientRolePermissionTemplate)" *ngIf="data.roleId !== null">Reset</button>
                        <button class="dropdown-item" type="button" *ngIf="data.roleId==null || data.roleId==undefined"
                          (click)="openModalWithClass(template)">Delete</button>
                      </div>
                    </div>
                  </div>
                </td>
                <!-- Delete Popup Html -->
                <ng-template #template>
                  <div class="modal-header">
                    <h4 class="modal-title pull-left">Confirmation</h4>
                    <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <div class="deleteModal">
                      <p><i class="fa fa-info-circle" aria-hidden="true"></i> Are you sure you want to delete this
                        role?</p>

                      <div class="bothButons">
                        <ul>
                          <li>
                            <button class="btn btn-default" (click)="modalRef.hide()">No</button>
                          </li>
                          <li>
                            <button class="btn btn-primary" (click)="deleteRole(data.clientRoleId)"
                              [disabled]="loadingforgot">Yes <span class="spinner-border spinner-border-own float-right"
                                *ngIf="loadingforgot" role="status" aria-hidden="true"></span></button>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </div>
                </ng-template>
                <!-- Delete Popup Html -->

                <!-- Reset ClientRolePermission Popup Html -->
                <ng-template #clientRolePermissionTemplate>
                  <div class="modal-header">
                    <h4 class="modal-title pull-left">Confirmation</h4>
                    <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <div class="deleteModal">
                      <p><i class="fa fa-info-circle" aria-hidden="true"></i> Are you sure you want to reset permissions
                        for this role?
                        <br>
                        The users with custom permissions in this role that might be effected as well if you select
                        “Reset For All” option.
                      </p>

                      <div class="bothButons">
                        <ul>
                          <li>
                            <button class="btn btn-primary" (click)="resetClientRolePermission(data.clientRoleId, true)"
                              [disabled]="loadingforgot">Reset For All <span
                                class="spinner-border spinner-border-own float-right" *ngIf="loadingforgot"
                                role="status" aria-hidden="true"></span></button>
                          </li>
                          <li>
                            <button class="btn btn-default"
                              (click)="resetClientRolePermission(data.clientRoleId, false)">Reset For This Role
                              Only</button>
                          </li>
                          <li>
                            <button class="btn btn-default" (click)="modalRef.hide()">Cancel</button>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </div>
                </ng-template>
                <!-- Reset ClientRolePermission Popup Html -->

              </tr>

            </tbody>
          </table>

          <div class="gifLoaderDiv" *ngIf="gifLoader">
            <img src="../../assets/images/gif-loader.gif" alt="">
          </div>

          <div class="noRecordDiv" *ngIf="roleList.length == 0 && gifLoader == false">
            <img src="../../assets/images/noRecordImg.png" alt="">
            <h1>No Record Found</h1>
          </div>






        </div>



      </div>
    </div>



    <div class="tab-pane fade" id="userRole"
      [ngClass]="{' show active ': permissions.RMRV != true && permissions.PRUMV == true}" role="tabpanel"
      aria-labelledby="withoutloan-tab" *ngIf="permissions.PRUMV">
      <div class="generalFeeTabDiv profile-user">
        <!-- <div class="row profile-filter">
          <div class="bg-lgray left col-md-12">
            <div class="row">
              <div class="searchBarApp col-md-12">
                <input placeholder="Search"
                  #searchInput class="form-control" (keyup)="focusOutSearchInput(searchInput.value)">
              </div>
            </div>
          </div>
        </div> -->

        <div class="row profile-filter">
          <div class="bg-lgray col-md left">
            <div class="row">
              <div class="searchBarApp col-md-6">
                <input placeholder="Search by Full Name, Email, Username, Contact Type" #searchInput
                  class="form-control" (keyup)="focusOutSearchInput(searchInput.value)">
              </div>
              <div class="selectFilters col-md">
                <select class="custom-select" (change)="selectedUserType($event.target.value)">
                  <option selected value="">All User Roles</option>
                  <option *ngFor="let dataPr of roleList" [value]="dataPr.clientRoleId">{{dataPr.roleName}}</option>
                </select>
              </div>

              <div class="selectFilters col-md">
                <select class="custom-select" (change)="selectedContactType($event.target.value)">
                  <option selected value="">All Contact Types</option>
                  <option *ngFor="let dataPr of contactType" [value]="dataPr.contactTypeId">{{dataPr.contactTypeName}}
                  </option>
                </select>
              </div>

              <!-- <div class="selectFilters col-md">
                <select class="custom-select" (change)="selectedBranch($event.target.value)">
                  <option selected value="">All Branches</option>
                  <option value="-1">N/A</option>
                  <option *ngFor="let dataPr of branches" [value]="dataPr.branchId">
                    {{dataPr.branchName}}</option>
                </select>
              </div> -->
            </div>
          </div>
          <div class="col-md-2 bg-lgray right" *ngIf="permissions.PRUMC == true">
            <button type="button" class="btn btn-primary" id="openPop" (click)="sendUserId(0, 0)">
              Add New</button>
          </div>
        </div>
        <br />
        <div class="row">
          <div class="col-md-12">
            <div class="tableGrids">
              <table class="table table-bordered">
                <thead class="thead-dark">
                  <tr>
                    <th scope="col" (click)="sort('userRoleName',clientUserList)"><i class="fa fa-sort" aria-hidden="true"></i>
                      User
                      Role</th>
                    <th scope="col" (click)="sort('userLogin',clientUserList)"><i class="fa fa-sort" aria-hidden="true"></i>
                      Username

                    </th>
                    <th scope="col" (click)="sort('firstName',clientUserList)"><i class="fa fa-sort" aria-hidden="true"></i> Full
                      Name
                    </th>
                    <th scope="col" (click)="sort('email',clientUserList)"><i class="fa fa-sort" aria-hidden="true"></i> Email</th>
                    <th scope="col" (click)="sort('contactTypeName',clientUserList)"><i class="fa fa-sort" aria-hidden="true"></i>
                      Contact Type</th>
                    <th scope="col" *ngIf="permissions.PRUMAV">Active</th>
                    <th scope="col">Actions</th>
                  </tr>
                </thead>
                <tbody>

                  <tr *ngFor="let data of clientUserList; let i = index">

                    <td>
                      {{data.clientRoleName}}
                    </td>
                    <td>
                      <h3 class="tdVHeading" (click)="sendUserId(data.userId, i)">
                        {{data.userLogin}}
                      </h3>
                    </td>
                    <td>
                      <span class="pro-icons">
                        <i class="fa fa-rush" aria-hidden="true" *ngIf="data.isCustomPermissionSet">C</i>
                      </span>
                      {{data.firstName}} {{data.lastName}}

                    </td>
                    <td>
                      {{data.email}}
                    </td>
                    <td>
                      {{data.contactTypeName}}
                    </td>
                    <td *ngIf="permissions.PRUMAV">

                      <mat-slide-toggle *ngIf="currentUserId!==data.userId" color="primary"
                        [(ngModel)]="!data.isBlocked" (change)="CheckBlockState($event, data.userId)">
                      </mat-slide-toggle>
                    </td>
                    <td>


                      <div class="editButtonDrop" *ngIf="!data.isBlocked">
                        <div class="btn-group">
                          <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"
                            aria-haspopup="true" aria-expanded="false">
                            <i class="fa fa-ellipsis-v" aria-hidden="true"></i>
                          </button>
                          <div class="dropdown-menu dropdown-menu-right">
                            <!-- (click)="editRowProductFun(i)" -->
                            <button class="dropdown-item" type="button" *ngIf="permissions.PRUMV == true"
                              (click)="viewUserId(data.userId)">View</button>
                            <button class="dropdown-item" type="button" *ngIf="permissions.PRUMU == true"
                              (click)="sendUserId(data.userId, i)">Edit</button>
                            <button class="dropdown-item" type="button" (click)="openModalWithClass(template)"
                              *ngIf="permissions.PRUMD == true && data.userRoleId != 1">Delete</button>
                            <button class="dropdown-item" type="button"
                              (click)="openEditSliderUser(data.clientRoleId,data.userId)"
                              *ngIf="data.userRoleId != 1 && permissions.PRUMSCPV == true">Set Custom
                              Permissions</button>
                            <button class="dropdown-item" type="button"
                              (click)="openModalWithClass(resetPermissionTemplate)"
                              *ngIf="permissions.PRUMU == true && data.isCustomPermissionSet == true">Reset
                              Permissions</button>
                            <button class="dropdown-item" type="button" *ngIf="permissions.PRUMCPV == true"
                              (click)="changePassFunction(data.userId)">Change
                              Password</button>
                            <button class="dropdown-item" type="button" (click)="SendPassLinkFunction(data.userLogin)"
                              *ngIf="currentUserId !== data.userId && permissions.PRUMSLV == true">Send
                              Pass Link</button>
                          </div>
                        </div>
                      </div>


                      <!-- Delete Popup Html -->
                      <ng-template #template>
                        <div class="modal-header">
                          <h4 class="modal-title pull-left">Confirmation</h4>
                          <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
                            <span aria-hidden="true">&times;</span>
                          </button>
                        </div>
                        <div class="modal-body">
                          <div class="deleteModal">
                            <p><i class="fa fa-info-circle" aria-hidden="true"></i> Are you sure you want to delete this
                              user?</p>

                            <div class="bothButons">
                              <ul>
                                <li>
                                  <button class="btn btn-default" (click)="modalRef.hide()">No</button>
                                </li>
                                <li>
                                  <!-- <button class="btn btn-primary" (click)="deleteLicense(data.userId)">Yes</button> -->
                                  <button class="btn btn-primary" (click)="deleteUser(data.userId)"
                                    [disabled]="loadingforgot">Yes <span
                                      class="spinner-border spinner-border-own float-right" *ngIf="loadingforgot"
                                      role="status" aria-hidden="true"></span></button>
                                </li>
                              </ul>
                            </div>
                          </div>
                        </div>
                      </ng-template>
                      <!-- Delete Popup Html -->


                      <!-- Reset Permission Popup Html -->
                      <ng-template #resetPermissionTemplate>
                        <div class="modal-header">
                          <h4 class="modal-title pull-left">Confirmation</h4>
                          <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
                            <span aria-hidden="true">&times;</span>
                          </button>
                        </div>
                        <div class="modal-body">
                          <div class="deleteModal">
                            <p><i class="fa fa-info-circle" aria-hidden="true"></i> Are you sure you want to reset the
                              permissions for this user?</p>

                            <div class="bothButons">
                              <ul>
                                <li>
                                  <!-- <button class="btn btn-primary" (click)="deleteLicense(data.userId)">Yes</button> -->
                                  <button class="btn btn-primary" (click)="resetUserRolePermission(data.userId)"
                                    [disabled]="loadingforgot">Reset <span
                                      class="spinner-border spinner-border-own float-right" *ngIf="loadingforgot"
                                      role="status" aria-hidden="true"></span></button>
                                </li>
                                <li>
                                  <button class="btn btn-default" (click)="modalRef.hide()">Cancel</button>
                                </li>

                              </ul>
                            </div>
                          </div>
                        </div>
                      </ng-template>
                      <!-- Reset Permission Popup Html -->

                      <!-- Activate Deactive Html Popup -->
                      <ng-template #templatestatus>
                        <div class="modal-header">
                          <h4 class="modal-title pull-left">Confirmation</h4>
                          <button type="button" class="close pull-right" aria-label="Close" (click)="closeModal()">
                            <span aria-hidden="true">&times;</span>
                          </button>
                        </div>
                        <div class="modal-body">
                          <div class="deleteModal">
                            <p><i class="fa fa-info-circle" aria-hidden="true"></i> Are you sure you want to <span
                                *ngIf="this.isblockedCurrentValue == true">activate</span> <span
                                *ngIf="this.isblockedCurrentValue == false">deactivate</span> this user?</p>

                            <div class="bothButons">
                              <ul>
                                <li>
                                  <button class="btn btn-default" (click)="closeModal()">No</button>
                                </li>
                                <li>
                                  <button class="btn btn-primary" [disabled]="loadingforgot"
                                    (click)="deleteIsBlocked()">Yes
                                    <span class="spinner-border spinner-border-own float-right" *ngIf="loadingforgot"
                                      role="status" aria-hidden="true"></span></button>
                                </li>
                              </ul>
                            </div>
                          </div>
                        </div>
                      </ng-template>
                      <!-- Activate Deactive Html Popup -->


                    </td>

                    <!-- Reset ClientRolePermission Popup Html -->
                    <ng-template #userRolePermissionTemplate>
                      <div class="modal-header">
                        <h4 class="modal-title pull-left">Confirmation</h4>
                        <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
                          <span aria-hidden="true">&times;</span>
                        </button>
                      </div>
                      <div class="modal-body">
                        <div class="deleteModal">
                          <p><i class="fa fa-info-circle" aria-hidden="true"></i> Are you sure you want to reset
                            permission
                            for this user?</p>

                          <div class="bothButons">
                            <ul>
                              <li>
                                <button class="btn btn-primary" (click)="resetUserRolePermission(data.userId)"
                                  [disabled]="loadingforgot">Reset <span
                                    class="spinner-border spinner-border-own float-right" *ngIf="loadingforgot"
                                    role="status" aria-hidden="true"></span></button>
                              </li>
                              <li>
                                <button class="btn btn-default" (click)="modalRef.hide()">Cancel</button>
                              </li>
                            </ul>
                          </div>
                        </div>
                      </div>
                    </ng-template>
                    <!-- Reset ClientRolePermission Popup Html -->
                  </tr>

                </tbody>
              </table>

              <div class="gifLoaderDiv" *ngIf="gifLoader">
                <img src="../../assets/images/gif-loader.gif" alt="">
              </div>

              <div class="noRecordDiv" *ngIf="clientUserList.length == 0 && gifLoader == false">
                <img src="../../assets/images/noRecordImg.png" alt="">
                <h1>No Record Found</h1>
              </div>

            </div>
          </div>
        </div>
      </div>

    </div>







  </div>

  <!-- For Edit Check List Slider -->
  <div class="LowVisibilityDiv addCheck">
    <div class="FormDivPopup" id="edit-sec-scroll">
      <h4 class="textCenter fz-18 ebold">Create Role</h4>
      <div class="formInerDiv">
        <form [formGroup]="roleForm" (ngSubmit)="onSave(roleForm.value)">
          <div class="formsRoleField">
            <div class="row">
              <div class="col-md-6">
                <div class="FieldBox">
                  <mat-form-field class="d-block">
                    <mat-icon matSuffix></mat-icon>
                    <mat-label>Role Name</mat-label>
                    <input matInput formControlName="roleName" required>
                    <mat-error *ngIf="validateForm(roleForm,'roleName', 'required')">Role name is required
                    </mat-error>
                    <mat-error *ngIf="validateForm(roleForm,'roleName', 'maxlength')">Role name should be less
                      than 100</mat-error>
                  </mat-form-field>
                </div>
              </div>

              <div class="col-md-12">
                <div class="FieldBox">
                  <mat-form-field class="d-block">
                    <mat-label>Role Description</mat-label>
                    <textarea matInput formControlName="description"></textarea>
                    <mat-error *ngIf="validateForm(roleForm,'description', 'maxlength')">Description
                      should be less than 1000</mat-error>
                  </mat-form-field>
                </div>
              </div>
            </div>
          </div>

          <!-- <h4 class="textCenter fz-18 ebold">User Role</h4> -->

          <div class="roleBox" *ngFor="let module of modal.modules">
            <h3>{{module.moduleName}}</h3>

            <div class="roleTableBox">
              <table class="table table-bordered">
                <thead>
                  <tr>
                    <th scope="col" width="30%"></th>
                    <th scope="col" width="10%">Full Access</th>
                    <th scope="col" width="10%">View</th>
                    <th scope="col" width="10%">Create</th>
                    <th scope="col" width="10%">Edit</th>
                    <th scope="col" width="10%">Delete</th>
                    <th scope="col" width="20%"></th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let permission of module.permissions">
                    <td>{{permission.permissionName}}</td>
                    <td>
                      <mat-checkbox color="primary"
                        [checked]="(permission.isView || !permission.isViewShow) && (permission.isCreate || !permission.isCreateShow) && (permission.isUpdate || !permission.isUpdateShow) && (permission.isDelete  || !permission.isDeleteShow)"
                        (change)="fullAccessNew($event,permission)"></mat-checkbox>
                    </td>
                    <td>
                      <mat-checkbox color="primary" *ngIf="permission.isViewShow" [checked]="permission.isView"
                        (change)="changeAccessNew($event,permission,'view')"></mat-checkbox>
                    </td>
                    <td>
                      <mat-checkbox color="primary" *ngIf="permission.isCreateShow" [disabled]="!permission.isView"
                        [checked]="permission.isCreate" (change)="changeAccessNew($event,permission,'create')">
                      </mat-checkbox>
                    </td>
                    <td>
                      <mat-checkbox color="primary" *ngIf="permission.isUpdateShow" [disabled]="!permission.isView"
                        [checked]="permission.isUpdate" (change)="changeAccessNew($event,permission,'update')">
                      </mat-checkbox>
                    </td>
                    <td>
                      <mat-checkbox color="primary" *ngIf="permission.isDeleteShow" [disabled]="!permission.isView"
                        [checked]="permission.isDelete" (change)="changeAccessNew($event,permission,'delete')">
                      </mat-checkbox>
                    </td>
                    <td>
                      <!-- <span class="permisionsStyleCustom" *ngIf="permission.permissions.length > 0">More Permissions</span> -->
                      <!-- <span *ngFor="let subPermission of permission.permissions">{{subPermission.permissionName}}</span> -->

                      <div class="btn-group" [insideClick]="true" dropdown *ngIf="permission.permissions.length > 0">
                        <button dropdownToggle type="button" class="btn btn-default dropdown-toggle"
                          aria-controls="dropdown-basic">
                          More Permissions <span class="caret"></span>
                        </button>
                        <ul id="dropdown-basic" *dropdownMenu class="dropdown-menu inerMenue" role="menu"
                          aria-labelledby="button-basic">
                          <li role="menuitem" *ngFor="let subPermission of permission.permissions">
                            <mat-checkbox color="primary" [checked]="subPermission.isView"></mat-checkbox>
                            {{subPermission.permissionName}}
                          </li>
                        </ul>
                      </div>

                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="pointsDiv">
              <p *ngFor="let permission of module.standalonePermissions">
                <mat-checkbox color="primary" [checked]="permission.isView"></mat-checkbox> Allow users to handle the
                data and transaction for {{permission.permissionName}}
              </p>
            </div>

          </div>

          <div class="row">
            <div class="col-md-12">
              <div class="requestBtn">

                <button class="btn btn-default" type="button" (click)="closeAddSlider()">
                  Canel</button>

                <button class="btn btn-primary" [disabled]="loadingforgot" type="submit">
                  <span class="spinner-border spinner-border-own float-right" *ngIf="loadingforgot"
                    aria-hidden="true"></span>
                  Save</button>
              </div>
            </div>
          </div>
        </form>
      </div>
      <button class="btn btn-default btn-close" (click)="closeAddSlider()"><i class="fa fa-times"
          aria-hidden="true"></i></button>
    </div>
  </div>
  <!-- For Edit Check List Slider -->


  <!-- For Edit Check List Slider -->
  <div class="LowVisibilityDiv editCheck">
    <div class="FormDivPopup" id="edit-sec-scroll">
      <h4 class="textCenter fz-18 ebold" *ngIf="isView == false">Edit Role</h4>
      <h4 class="textCenter fz-18 ebold" *ngIf="isView == true">Role</h4>
      <div class="formInerDiv" [hidden]="gifLoaderForm">
        <form [formGroup]="roleForm">
          <div class="formsRoleField">
            <div class="row">
              <div class="col-md-6">
                <div class="FieldBox">
                  <mat-form-field class="d-block">
                    <mat-icon matSuffix></mat-icon>
                    <mat-label>Role Name</mat-label>
                    <input matInput formControlName="roleName" required (change)="updateName(roleForm.value)"
                      [readOnly]="isView">
                    <mat-error *ngIf="validateForm(roleForm,'roleName', 'required')">Template name is required
                    </mat-error>
                    <mat-error *ngIf="validateForm(roleForm,'roleName', 'maxlength')">Template name should be less
                      than 100</mat-error>
                  </mat-form-field>
                </div>
              </div>

              <div class="col-md-12">
                <div class="FieldBox">
                  <mat-form-field class="d-block">
                    <mat-label>Role Description</mat-label>
                    <textarea matInput formControlName="description" (change)="updateName(roleForm.value)"
                      [readOnly]="isView"></textarea>
                    <mat-error *ngIf="validateForm(roleForm,'description', 'maxlength')">Description
                      should be less than 1000</mat-error>
                  </mat-form-field>
                </div>
              </div>
            </div>
          </div>

          <!-- <h4 class="textCenter fz-18 ebold">User Role</h4> -->

          <div class="roleBox" *ngFor="let module of modal.modules">
            <h3>{{module.moduleName}}</h3>

            <div class="roleTableBox">
              <table class="table table-bordered">
                <thead>
                  <tr>
                    <th scope="col" width="30%"></th>
                    <th scope="col" width="10%">Full Access</th>
                    <th scope="col" width="10%">View</th>
                    <th scope="col" width="10%">Create</th>
                    <th scope="col" width="10%">Edit</th>
                    <th scope="col" width="10%">Delete</th>
                    <th scope="col" width="20%"></th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let permission of module.permissions">
                    <td>{{permission.permissionName}}</td>
                    <td>
                      <mat-checkbox color="primary"
                        [checked]="(permission.isView || !permission.isViewShow) && (permission.isCreate || !permission.isCreateShow) && (permission.isUpdate || !permission.isUpdateShow) && (permission.isDelete  || !permission.isDeleteShow)"
                        (change)="openPermissionModalWithClass(permissionCheck, $event, permission, 'fullAccess', modal.clientRoleId)"
                        [disabled]="isView"></mat-checkbox>

                      <!-- (change)="fullAccess($event,permission)" -->
                    </td>
                    <td>
                      <mat-checkbox color="primary" *ngIf="permission.isViewShow" [checked]="permission.isView"
                        (change)="openPermissionModalWithClass(permissionCheck, $event, permission, 'view', modal.clientRoleId)"
                        [disabled]="isView"></mat-checkbox>
                      <!-- (change)="changeAccess($event,permission,'view')" -->
                    </td>
                    <td>
                      <mat-checkbox color="primary" *ngIf="permission.isCreateShow" [disabled]="!permission.isView"
                        [checked]="permission.isCreate"
                        (change)="openPermissionModalWithClass(permissionCheck,$event,  permission, 'create', modal.clientRoleId)"
                        [disabled]="isView"></mat-checkbox>

                      <!-- (change)="changeAccess($event,permission,'create')" -->
                    </td>
                    <td>
                      <mat-checkbox color="primary" *ngIf="permission.isUpdateShow" [disabled]="!permission.isView"
                        [checked]="permission.isUpdate"
                        (change)="openPermissionModalWithClass( permissionCheck, $event, permission, 'update', modal.clientRoleId)"
                        [disabled]="isView"></mat-checkbox>

                      <!-- (change)="changeAccess($event,permission,'update')" -->
                    </td>
                    <td>
                      <mat-checkbox color="primary" *ngIf="permission.isDeleteShow" [disabled]="!permission.isView"
                        [checked]="permission.isDelete"
                        (change)="openPermissionModalWithClass( permissionCheck, $event, permission, 'delete', modal.clientRoleId)"
                        [disabled]="isView"></mat-checkbox>

                      <!-- (change)="changeAccess($event,permission,'delete')" -->
                    </td>
                    <td>
                      <!-- <span class="permisionsStyleCustom" *ngIf="permission.permissions.length > 0">More Permissions</span>
                      <span *ngFor="let subPermission of permission.permissions">{{subPermission.permissionName}}</span> -->

                      <div class="btn-group" [insideClick]="true" dropdown *ngIf="permission.permissions.length > 0">
                        <button dropdownToggle type="button" class="btn btn-default dropdown-toggle"
                          aria-controls="dropdown-basic">
                          More Permissions <span class="caret"></span>
                        </button>
                        <ul id="dropdown-basic" *dropdownMenu class="dropdown-menu inerMenue" role="menu"
                          aria-labelledby="button-basic">
                          <li role="menuitem" *ngFor="let subPermission of permission.permissions">
                            <mat-checkbox color="primary" [checked]="subPermission.isView"
                              (change)="openPermissionModalWithClass( permissionCheck, $event, subPermission, 'delete', modal.clientRoleId)"
                              [disabled]="isView"></mat-checkbox>

                            <!-- (change)="changeAccess($event,subPermission,'view')" -->
                            {{subPermission.permissionName}}
                          </li>
                        </ul>
                      </div>

                    </td>

                  </tr>
                </tbody>
              </table>
            </div>

            <div class="pointsDiv">
              <p *ngFor="let permission of module.standalonePermissions">
                <mat-checkbox color="primary"
                  (change)="openPermissionModalWithClass(permissionCheck, $event, permission, 'view', modal.clientRoleId)"
                  [checked]="permission.isView" [disabled]="isView"></mat-checkbox>
                <!-- (change)="changeAccess($event,permission,'view')" -->
                <!-- (click)="openPermissionModalWithClass(permissionCheck, $event, permission, 'view')" -->
                Allow users to
                handle the data and transaction for {{permission.permissionName}}
              </p>
            </div>



          </div>

        </form>
      </div>
      <div class="gifLoaderDiv" [hidden]="!gifLoaderForm">
        <img src="../../assets/images/gif-loader.gif" alt="">
      </div>
      <button class="btn btn-default btn-close" (click)="closeEditSlider()"><i class="fa fa-times"
          aria-hidden="true"></i></button>
    </div>
  </div>
  <!-- For Edit Check List Slider -->

  <!-- For Edit User Check List Slider -->
  <div class="LowVisibilityDiv editUserCheck">
    <div class="FormDivPopup" id="edit-sec-scroll">
      <h4 class="textCenter fz-18 ebold" *ngIf="isView == false">Edit User Role</h4>
      <h4 class="textCenter fz-18 ebold" *ngIf="isView == true">User Role</h4>
      <div class="formInerDiv" [hidden]="gifLoaderForm">
        <form>
          <!-- <h4 class="textCenter fz-18 ebold">User Role</h4> -->

          <div class="roleBox" *ngFor="let module of modal.modules">
            <h3>{{module.moduleName}}</h3>

            <div class="roleTableBox">
              <table class="table table-bordered">
                <thead>
                  <tr>
                    <th scope="col" width="30%"></th>
                    <th scope="col" width="10%">Full Access</th>
                    <th scope="col" width="10%">View</th>
                    <th scope="col" width="10%">Create</th>
                    <th scope="col" width="10%">Edit</th>
                    <th scope="col" width="10%">Delete</th>
                    <th scope="col" width="20%"></th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let permission of module.permissions">
                    <td>{{permission.permissionName}}</td>
                    <td>
                      <mat-checkbox color="primary"
                        [checked]="(permission.isView || !permission.isViewShow) && (permission.isCreate || !permission.isCreateShow) && (permission.isUpdate || !permission.isUpdateShow) && (permission.isDelete  || !permission.isDeleteShow)"
                        (change)="fullAccessUser($event,permission)" [disabled]="isView"></mat-checkbox>
                    </td>
                    <td>
                      <mat-checkbox color="primary" *ngIf="permission.isViewShow" [checked]="permission.isView"
                        (change)="changeAccessUser($event,permission,'view')" [disabled]="isView"></mat-checkbox>
                    </td>
                    <td>
                      <mat-checkbox color="primary" *ngIf="permission.isCreateShow" [disabled]="!permission.isView"
                        [checked]="permission.isCreate" (change)="changeAccessUser($event,permission,'create')"
                        [disabled]="isView"></mat-checkbox>
                    </td>
                    <td>
                      <mat-checkbox color="primary" *ngIf="permission.isUpdateShow" [disabled]="!permission.isView"
                        [checked]="permission.isUpdate" (change)="changeAccessUser($event,permission,'update')"
                        [disabled]="isView"></mat-checkbox>
                    </td>
                    <td>
                      <mat-checkbox color="primary" *ngIf="permission.isDeleteShow" [disabled]="!permission.isView"
                        [checked]="permission.isDelete" (change)="changeAccessUser($event,permission,'delete')"
                        [disabled]="isView"></mat-checkbox>
                    </td>
                    <td>
                      <!-- <span class="permisionsStyleCustom" *ngIf="permission.permissions.length > 0">More Permissions</span>
                      <span *ngFor="let subPermission of permission.permissions">{{subPermission.permissionName}}</span> -->

                      <div class="btn-group" [insideClick]="true" dropdown *ngIf="permission.permissions.length > 0">
                        <button dropdownToggle type="button" class="btn btn-default dropdown-toggle"
                          aria-controls="dropdown-basic">
                          More Permissions <span class="caret"></span>
                        </button>
                        <ul id="dropdown-basic" *dropdownMenu class="dropdown-menu inerMenue" role="menu"
                          aria-labelledby="button-basic">
                          <li role="menuitem" *ngFor="let subPermission of permission.permissions">
                            <mat-checkbox color="primary" [checked]="subPermission.isView"
                              (change)="changeAccessUser($event,subPermission,'view')" [disabled]="isView">
                            </mat-checkbox> {{subPermission.permissionName}}
                          </li>
                        </ul>
                      </div>

                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="pointsDiv">
              <p *ngFor="let permission of module.standalonePermissions">
                <mat-checkbox color="primary" [checked]="permission.isView"
                  (change)="changeAccessUser($event,permission,'view')" [disabled]="isView"></mat-checkbox> Allow users
                to handle the data and transaction for {{permission.permissionName}}
              </p>
            </div>

          </div>

        </form>
      </div>
      <div class="gifLoaderDiv" [hidden]="!gifLoaderForm">
        <img src="../../assets/images/gif-loader.gif" alt="">
      </div>
      <button class="btn btn-default btn-close" (click)="closeEditSliderUser()"><i class="fa fa-times"
          aria-hidden="true"></i></button>
    </div>
  </div>
  <!-- For Edit User Check List Slider -->


  <!-- User Managment popus -->
  <div class="LowVisibilityDiv LowVisibilityDivCreatedEditUser">
    <div class="FormDivPopup userForm" id="edit-sec-scroll">
      <h4 class="textCenter fz-18 ebold">{{heading}}  <span (click)="removeFields(userFormDirective)">clear Fields</span></h4>
      <form [formGroup]="UserCustomForm" #userFormDirective="ngForm" (ngSubmit)="onSaveUser(UserCustomForm.value, userFormDirective)">
        <div class="row">
          <div class="col-md-12">
            <div class="form-row">
              <input type="hidden" formControlName="userId">
              <!-- <input type="hidden" formControlName="userRoleId"> -->

              <div class="col-md-12">
                <div class="FieldBox">
                  <mat-form-field class="d-block">
                    <!-- <mat-label>User Role</mat-label> -->
                    <mat-select placeholder="User Role" formControlName="clientRoleId" required
                      [disabled]="!allowRoleUpdate && isEdit">
                      <mat-option *ngFor="let dataPr of roleList" [value]="dataPr.clientRoleId">
                        <!-- (selectionChange)="userRoleNameMethod($event.value)" -->
                        {{dataPr.roleName}}
                      </mat-option>
                    </mat-select>
                    <mat-error *ngIf="validateForm(UserCustomForm,'clientRoleId', 'min')">User Role is not selected</mat-error>
                  </mat-form-field>
                </div>
              </div>

              <div class="col-md-12">
                <div class="FieldBox">
                  <mat-form-field class="d-block">
                    <!-- <mat-label>Contact Type</mat-label> -->
                    <mat-select placeholder="Contact Type" formControlName="contactTypeId" required>
                      <mat-option *ngFor="let dataPr of contactType" [value]="dataPr.contactTypeId">
                        {{dataPr.contactTypeName}}
                      </mat-option>
                    </mat-select>
                    <mat-error *ngIf="validateForm(UserCustomForm,'contactTypeId', 'min')">Contact Type is not selected</mat-error>
                  </mat-form-field>
                </div>
              </div>


              <div class="col-md-12">
                <div class="FieldBox">
                  <mat-form-field class="d-block">
                    <mat-icon matSuffix></mat-icon>
                    <mat-label>First Name</mat-label>
                    <input matInput formControlName="firstName" required>
                    <mat-error *ngIf="validateForm(UserCustomForm,'firstName', 'required')">First name is required</mat-error>
                    <mat-error *ngIf="validateForm(UserCustomForm,'firstName', 'maxlength')">First name should be less than 100
                      characters</mat-error>
                    <mat-error *ngIf="validateForm(UserCustomForm,'firstName', 'pattern')">First name can include numbers, period ( .
                      ),
                      hyphen ( - ) and apostrophe ( ' )</mat-error>
                    <mat-error *ngIf="validateForm(UserCustomForm,'firstName', 'trimError')">First name cannot contain space
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>

              <div class="col-md-12">
                <div class="FieldBox">
                  <mat-form-field class="d-block">
                    <mat-icon matSuffix></mat-icon>
                    <mat-label>Last Name</mat-label>
                    <input matInput formControlName="lastName" required>
                    <mat-error *ngIf="validateForm(UserCustomForm,'lastName', 'required')">Last name is required</mat-error>
                    <mat-error *ngIf="validateForm(UserCustomForm,'lastName', 'maxlength')">Last name should be less than 100
                      characters
                    </mat-error>
                    <mat-error *ngIf="validateForm(UserCustomForm,'lastName', 'pattern')">Last name can include numbers, period ( .
                      ),
                      hyphen ( - ) and apostrophe ( ' )</mat-error>
                    <mat-error *ngIf="validateForm(UserCustomForm,'lastName', 'trimError')">Last name cannot contain space
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>

              <div class="col-md-12">
                <div class="FieldBox">
                  <mat-form-field class="d-block">
                    <mat-icon matSuffix><i class="fa fa-envelope-o" aria-hidden="true"></i></mat-icon>
                    <mat-label>Email</mat-label>
                    <input matInput formControlName="userEmail" required>
                    <mat-error *ngIf="validateForm(UserCustomForm,'userEmail', 'required')">Email is required
                    </mat-error>
                    <mat-error *ngIf="validateForm(UserCustomForm,'userEmail', 'pattern')">Email is invalid
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>


              <div class="col-md-12" *ngIf="setting != undefined && setting.branchEnable ">
                <div class="FieldBox">
                  <mat-form-field class="d-block">
                    <mat-label>Select Branches</mat-label>
                    <mat-select formControlName="userBranches" multiple>

                      <mat-select-trigger>
                        <mat-chip-list>
                          <mat-chip *ngFor="let toppings of UserCustomForm.controls['userBranches'].value"
                            [removable]="true" (removed)="onToppingRemoved(toppings)">
                            {{ toppings }}
                            <mat-icon *ngIf="isView == false" matChipRemove>cancel</mat-icon>
                          </mat-chip>
                        </mat-chip-list>
                      </mat-select-trigger>

                      <mat-option (onSelectionChange)="changeBranches($event)" *ngFor="let topping of branches"
                        [value]="topping.branchName">
                        {{topping.branchName}}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </div>

              <div class="col-md-12" *ngIf="setting != undefined && setting.subGroupEnable && subGroups.length>0">
                <div class="FieldBox">
                  <mat-form-field class="d-block">
                    <mat-label>Select Sub Groups</mat-label>
                    <mat-select formControlName="userSubGroups" multiple>

                      <mat-select-trigger>
                        <mat-chip-list>
                          <mat-chip *ngFor="let toppings of UserCustomForm.controls['userSubGroups'].value"
                            [removable]="true" (removed)="onSubGroupRemoved(toppings)">
                            {{ toppings }}
                            <mat-icon *ngIf="isView == false" matChipRemove>cancel</mat-icon>
                          </mat-chip>
                        </mat-chip-list>
                      </mat-select-trigger>

                      <mat-option *ngFor="let topping of subGroups" [value]="topping.branchName">
                        {{topping.branchName}}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
              </div>



              <div class="col-md-12">
                <div class="FieldBox">
                  <mat-form-field class="d-block">
                    <mat-icon matSuffix><i class="fa fa-phone" aria-hidden="true"></i></mat-icon>
                    <mat-label>Work Phone</mat-label>
                    <input matInput formControlName="userWorkPhone" mask="000-000-0000">
                    <mat-error *ngIf="!UserCustomForm.controls['userWorkPhone'].valid">Work Phone must be in correct
                      format (XXX-XXX-XXXX)</mat-error>
                  </mat-form-field>
                </div>
              </div>


              <div class="col-md-12">
                <div class="FieldBox">
                  <mat-form-field class="d-block">
                    <mat-icon matSuffix><i class="fa fa-phone" aria-hidden="true"></i></mat-icon>
                    <mat-label>Cell Phone</mat-label>
                    <input matInput formControlName="userCellPhone" mask="000-000-0000">
                    <mat-error *ngIf="!UserCustomForm.controls['userCellPhone'].valid">
                      User Cell Phone must be in correct format (XXX-XXX-XXXX)
                    </mat-error>
                  </mat-form-field>
                </div>
              </div>

              <div class="col-md-12">
                <div class="FieldBox">
                  <mat-form-field class="d-block">
                    <mat-icon matSuffix></mat-icon>
                    <mat-label>User Name</mat-label>
                    <input matInput formControlName="userLogin" required />
                    <mat-error *ngIf="validateForm(UserCustomForm,'userLogin', 'required')">Username is required </mat-error>
                    <mat-error *ngIf="validateForm(UserCustomForm,'userLogin', 'maxlength')">Username should be less than 100
                      characters
                    </mat-error>
                    <mat-error *ngIf="validateForm(UserCustomForm,'userLogin', 'cannotContainSpace')">Username cannot contain space
                    </mat-error>validateForm
                  </mat-form-field>
                </div>
              </div>

              <div class="col-md-12" *ngIf="!isEdit">
                <mat-form-field class="d-block mb-3">
                  <!-- <mat-icon matPrefix><i class="fa fa-lock iconBg" aria-hidden="true"></i></mat-icon> -->
                  <mat-label>Enter New password</mat-label>
                  <input matInput [type]="hide ? 'password' : 'text'" formControlName="password">
                  <mat-error *ngIf="!UserCustomForm.controls['password'].valid">
                    Password must contains at least 8 characters one numeric one uppercase one lowercase and one special
                    character
                  </mat-error>
                  <button class="btn btn-default" type="button" mat-icon-button matSuffix (click)="hide = !hide"
                    [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hide">
                    <mat-icon>{{hide ? 'visibility_off' : 'visibility'}}</mat-icon>
                  </button>
                </mat-form-field>
              </div>

              <div class="col-md-12" *ngIf="!isEdit">
                <mat-form-field class="d-block pb-3">
                  <!-- <mat-icon matPrefix><i class="fa fa-lock iconBg" aria-hidden="true"></i></mat-icon> -->
                  <mat-label>Confirm New Password</mat-label>
                  <input matInput [type]="hide ? 'password' : 'text'" formControlName="confirmPassword">
                  <mat-error *ngIf="!UserCustomForm.controls['confirmPassword'].valid">{{ getErrorPasswordUser() }}
                  </mat-error>

                  <!-- <mat-error *ngIf="checkError('confirmPassword', 'required')">Confirm Password is required </mat-error> -->


                  <mat-error *ngIf="UserCustomForm.controls['confirmPassword'].errors?.MatchPassword">
                    Password does not match</mat-error>


                  <!-- <mat-error *ngIf="!UserCustomForm.controls['confirmPassword'].valid" >Password does not match
                  </mat-error> -->
                  <button class="btn btn-default" mat-icon-button matSuffix (click)="hide = !hide"
                    [attr.aria-label]="'Hide password'" type="button" [attr.aria-pressed]="hide">
                    <mat-icon>{{hide ? 'visibility_off' : 'visibility'}}</mat-icon>
                  </button>
                </mat-form-field>
              </div>

              <div class="col-md-12" *ngIf="!isEdit">
                <mat-checkbox color="primary" formControlName="isChangePasswordFirstLogin"></mat-checkbox> Require
                Password Change
              </div>

            </div>
          </div>
        </div>


        <div class="row actionButton justify-content-center" *ngIf="isView == false">
          <button class="btn btn-primary" [disabled]="loadingforgot" type="submit"> <span
              class="spinner-border spinner-border-own float-right" *ngIf="loadingforgot" role="status"
              aria-hidden="true"></span>{{btnHeading}}</button>
        </div>

      </form>

      <button class="btn btn-default btn-close btn-close btn-close-edituser"><i class="fa fa-times"
          aria-hidden="true"></i></button>
    </div>
  </div>

  <div class="LowVisibilityDiv LowVisibilityDivChangePassword">
    <div class="FormDivPopup userForm" id="edit-sec-scroll">
      <h4 class="textCenter fz-18 ebold">Change Password</h4>
      <form [formGroup]="ChangePasswordFrom" (ngSubmit)="onChangePassword(ChangePasswordFrom.value)">
        <div class="row">
          <div class="col-md-12">
            <div class="form-row">

              <div class="col-md-12">
                <mat-form-field class="d-block mb-3">
                  <!-- <mat-icon matPrefix><i class="fa fa-lock iconBg" aria-hidden="true"></i></mat-icon> -->
                  <mat-label>Enter New password</mat-label>
                  <input matInput [type]="hide ? 'password' : 'text'" formControlName="password">
                  <mat-error *ngIf="!ChangePasswordFrom.controls['password'].valid">
                    Password must contains at least 8 characters one numeric one uppercase one lowercase and one special
                    character
                  </mat-error>
                  <button class="btn btn-default" type="button" mat-icon-button matSuffix (click)="hide = !hide"
                    [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hide">
                    <mat-icon>{{hide ? 'visibility_off' : 'visibility'}}</mat-icon>
                  </button>
                </mat-form-field>
              </div>

              <div class="col-md-12">
                <mat-form-field class="d-block pb-3">
                  <!-- <mat-icon matPrefix><i class="fa fa-lock iconBg" aria-hidden="true"></i></mat-icon> -->
                  <mat-label>Confirm New Password</mat-label>
                  <input matInput [type]="hide ? 'password' : 'text'" formControlName="confirmPassword">
                  <mat-error *ngIf="!ChangePasswordFrom.controls['confirmPassword'].valid">
                    {{ getErrorPasswordConfirmPass() }}</mat-error>
                  <mat-error *ngIf="ChangePasswordFrom.controls['confirmPassword'].errors?.MatchPassword">
                    Password does not match</mat-error>
                  <button class="btn btn-default" type="button" mat-icon-button matSuffix (click)="hide = !hide"
                    [attr.aria-label]="'Hide password'" [attr.aria-pressed]="hide">
                    <mat-icon>{{hide ? 'visibility_off' : 'visibility'}}</mat-icon>
                  </button>
                </mat-form-field>
              </div>

              <div class="col-md-12">
                <mat-checkbox color="primary" formControlName="isChangePasswordFirstLogin"></mat-checkbox> Require
                Password Change
              </div>




            </div>
          </div>
        </div>
        <br />
        <div class="row justify-content-center">
          <button class="btn btn-primary" [disabled]="loadingforgot" type="submit"> <span
              class="spinner-border spinner-border-own float-right" *ngIf="loadingforgot" role="status"
              aria-hidden="true"></span>Save</button>
        </div>
      </form>
      <button class="btn btn-default btn-close btn-close-change-password"><i class="fa fa-times"
          aria-hidden="true"></i></button>
    </div>
  </div>

  <!-- User Managment popus -->

</div>



<!-- Permission Check Popup Html -->
<ng-template #permissionCheck>
  <div class="modal-header">
    <h4 class="modal-title pull-left">Confirmation</h4>
    <button type="button" class="close pull-right" aria-label="Close" (click)="closePermissionCheck()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="deleteModal">
      <p *ngIf="permissionEventCheck == true"><i class="fa fa-info-circle" aria-hidden="true"></i> Do you also want to
        add this permission for the following user(s) having custom permissions?
        <br>
        <b>
          {{ clientUserNames }} </b>
      </p>

      <p *ngIf="permissionEventCheck == false"><i class="fa fa-info-circle" aria-hidden="true"></i> Do you also want to
        remove this permission for the following user(s) having custom permissions?
        <br>
        <b>
          {{ clientUserNames }} </b>
      </p>



      <div class="bothButons">
        <ul>
          <li>
            <button class="btn btn-default" (click)="assignCustomPermission(false)">No</button>
          </li>
          <li>
            <button class="btn btn-primary" (click)="assignCustomPermission(true)" [disabled]="loadingforgot">Yes <span
                class="spinner-border spinner-border-own float-right" *ngIf="loadingforgot" role="status"
                aria-hidden="true"></span></button>
          </li>
        </ul>
      </div>
    </div>
  </div>
</ng-template>
<!-- Permission Check Popup Html -->
